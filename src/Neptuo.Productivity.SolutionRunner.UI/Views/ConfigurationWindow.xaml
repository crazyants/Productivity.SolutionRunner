<Window x:Class="Neptuo.Productivity.SolutionRunner.Views.ConfigurationWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d" 
        xmlns:dd="clr-namespace:Neptuo.Productivity.SolutionRunner.UI.DesignData" d:DataContext="{x:Static dd:ViewModelLocator.ConfigurationViewModel}"
        xmlns:ui="clr-namespace:Neptuo.Productivity.SolutionRunner.Views.Controls"
        xmlns:ds="clr-namespace:Neptuo.Productivity.SolutionRunner.Views.DataSources"
        xmlns:converters="clr-namespace:Neptuo.Productivity.SolutionRunner.Services.Converters"
        Title="Solution runner - Configuration" Width="510" SizeToContent="Height" ResizeMode="NoResize" 
        ShowInTaskbar="False" Background="{StaticResource BackgroundBrush}" WindowStartupLocation="CenterScreen"  WindowStyle="None"
        PreviewKeyDown="OnPreviewKeyDown" PreviewMouseDown="OnPreviewMouseDown" Closing="OnClosing">
    <Window.Resources>
        <converters:NullToBoolConverter x:Key="notNullToBool" IsInverted="True" />

        <Style x:Key="RootPanelStyle" TargetType="DockPanel">
            <Setter Property="Margin" Value="10" />
        </Style>
        <Style x:Key="EditorPanelStyle" TargetType="StackPanel">
            <Setter Property="Margin" Value="0,0,0,10" />
        </Style>
        <Style TargetType="Label">
            <Setter Property="Padding" Value="2" />
            <Setter Property="Foreground" Value="White" />
        </Style>
        <Style TargetType="TextBlock" BasedOn="{StaticResource GrayStyle}">
            <Setter Property="Padding" Value="2" />
        </Style>
        <Style x:Key="ActionBarStyle" TargetType="StackPanel">
            <Setter Property="Orientation" Value="Horizontal" />
            <Setter Property="Margin" Value="0,15,0,0" />
        </Style>
        <Style TargetType="Button">
            <Setter Property="Margin" Value="10,0,0,0" />
            <Setter Property="Padding" Value="6,4" />
        </Style>
        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="{StaticResource TextBoxBackgroundBrush}" />
        </Style>
    </Window.Resources>
    <Border BorderBrush="{StaticResource ActiveBrush}" BorderThickness="1" Padding="0,10">
        <DockPanel Style="{StaticResource RootPanelStyle}">
            <Grid DockPanel.Dock="Bottom">
                <StackPanel VerticalAlignment="Bottom" Orientation="Horizontal">
                    <Button x:Name="btnAbout" Click="btnAbout_Click" Margin="0,0,5,0" Height="15">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <TextBlock Text="About" Foreground="#4A9AD4" TextDecorations="Underline" Cursor="Hand" ToolTip="www.neptuo.com/project/desktop/solution-runner" Margin="0" Padding="0" />
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <TextBlock Text="{Binding Version}" />
                </StackPanel>

                <StackPanel HorizontalAlignment="Right" Style="{StaticResource ActionBarStyle}">
                    <Button Content="Apply" Command="{Binding SaveCommand}" IsDefault="True" />
                    <Button x:Name="btnCancel" Click="btnCancel_Click" Content="Cancel" IsCancel="True" />
                </StackPanel>
            </Grid>

            <StackPanel>
                <StackPanel Style="{StaticResource EditorPanelStyle}">
                    <Grid>
                        <Label Content="Root directory:" Target="{Binding ElementName=tbxSourceDirectory}" />
                        <TextBlock Text="Directory where to search for solution files" HorizontalAlignment="Right" />
                    </Grid>
                    <TextBox x:Name="tbxSourceDirectory" Text="{Binding SourceDirectoryPath, UpdateSourceTrigger=PropertyChanged}" Margin="0" />
                </StackPanel>
                <StackPanel Style="{StaticResource EditorPanelStyle}">
                    <Grid>
                        <Label Content="Prefered application:" Target="{Binding ElementName=tbxSourceDirectory}" />
                        <TextBlock Text="Full path to prefered (preselected) application" HorizontalAlignment="Right" />
                    </Grid>
                    <TextBox x:Name="tbxPreferedApplication" Text="{Binding PreferedApplicationPath, UpdateSourceTrigger=PropertyChanged}" Margin="0" />
                </StackPanel>
                <StackPanel Style="{StaticResource EditorPanelStyle}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100" />
                            <ColumnDefinition Width="130" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <StackPanel Style="{StaticResource EditorPanelStyle}" Margin="0,0,10,0">
                            <Label Content="Search mode:" Target="{Binding ElementName=cbxFileSearchMode}" />
                            <ListBox ItemsSource="{ds:FileSearchModes}" SelectedItem="{Binding FileSearchMode}" SelectionMode="Single" Background="Transparent" BorderThickness="0">
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="{x:Type ListBoxItem}" >
                                        <Setter Property="Margin" Value="2" />
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                                    <Border Name="theBorder" Background="Transparent">
                                                        <RadioButton Focusable="False" IsHitTestVisible="False" IsChecked="{TemplateBinding IsSelected}" Padding="2,-1,0,0">
                                                            <TextBlock Text="{Binding}" Foreground="White" />
                                                        </RadioButton>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ListBox.ItemContainerStyle>
                            </ListBox>
                        </StackPanel>
                        <StackPanel Style="{StaticResource EditorPanelStyle}" Margin="0,0,50,0" Grid.Column="1">
                            <Label Content="Search count:" Target="{Binding ElementName=tbxFileSearchCount}" />
                            <TextBox x:Name="tbxFileSearchCount" Text="{Binding FileSearchCount}" Margin="0" />
                        </StackPanel>
                        <StackPanel Style="{StaticResource EditorPanelStyle}" Grid.Column="2">
                            <Label Content="Others:" />
                            <CheckBox Content="Save last searched phrase" IsChecked="{Binding IsFileSearchPatternSaved}" />
                            <CheckBox Content="Save last used application as prefered" IsChecked="{Binding IsLastUsedApplicationSavedAsPrefered}" />
                            <CheckBox Content="Dismiss after loosing focus" IsChecked="{Binding IsDismissedWhenLostFocus}" />
                            <CheckBox Content="Start hidden (only when hotkey is set)" IsChecked="{Binding IsHiddentOnStartup}" IsEnabled="{Binding RunKey, Converter={StaticResource notNullToBool}}" />
                        </StackPanel>
                    </Grid>
                </StackPanel>
                <StackPanel Style="{StaticResource EditorPanelStyle}">
                    <Grid>
                        <Label Content="Global hotkey:" Target="{Binding ElementName=tbxRunHotKey}" />
                        <TextBlock Text="Ctrl + Windows + V or the another of your preference" HorizontalAlignment="Right"/>
                    </Grid>
                    <TextBox x:Name="tbxRunHotKey" Margin="0" ui:HotKeyTextBox.Key="{Binding RunKey, Mode=TwoWay}" />
                    <TextBlock TextWrapping="Wrap">
                        When the hot key is not set, the application exits when the main window is closed. 
                        Otherwise the application is hidden and it is triggered to the front by pressing the hot key.
                    </TextBlock>
                </StackPanel>

                <StackPanel Style="{StaticResource EditorPanelStyle}">
                    <Label Content="Keyboard shortcuts" />
                    <Grid>
                        <TextBlock Text="Switch application" />
                        <TextBlock Text="Ctrl+Tab, Ctrl+Shift+Tab" HorizontalAlignment="Right" />
                    </Grid>
                    <Grid>
                        <TextBlock Text="Switch file" />
                        <TextBlock Text="ArrowDown, ArrowUp, Home, End" HorizontalAlignment="Right" />
                    </Grid>
                    <Grid>
                        <TextBlock Text="Pin/unpin file" />
                        <TextBlock Text="Ctrl+S" HorizontalAlignment="Right" />
                    </Grid>
                    <Grid>
                        <TextBlock Text="Open empty instance of application" />
                        <TextBlock Text="DoubleClick on application" HorizontalAlignment="Right" />
                    </Grid>
                    <Grid>
                        <TextBlock Text="Open file in application" />
                        <TextBlock Text="Enter, DoubleClick on file" HorizontalAlignment="Right" />
                    </Grid>
                    <Grid>
                        <TextBlock Text="Close/hide" />
                        <TextBlock Text="Escape" HorizontalAlignment="Right" />
                    </Grid>
                </StackPanel>
            </StackPanel>
        </DockPanel>
    </Border>
</Window>
